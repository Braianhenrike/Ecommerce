{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/braia/Desktop/Ecommerce/Front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/braia/Desktop/Ecommerce/Front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport axios from 'axios';\naxios.defaults.baseURL = 'http://localhost:8080';\nexport var setAuthHeader = function setAuthHeader(token) {\n  axios.defaults.headers.common['Authorization'] = \"Bearer \".concat(token);\n  window.localStorage.setItem('apiToken', token);\n};\nexport var clearAuthHeader = function clearAuthHeader() {\n  delete axios.defaults.headers.common['Authorization'];\n  window.localStorage.removeItem('apiToken');\n};\nexport var getUserInfo = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", request(\"GET\", \"/auth/user-info\"));\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function getUserInfo() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var updateUser = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(userId, userDTO) {\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          return _context2.abrupt(\"return\", request(\"PUT\", \"/user-profile/\".concat(userId), userDTO));\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return function updateUser(_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar request = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(method, url, data) {\n    var token, headers, response;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          token = window.localStorage.getItem('apiToken');\n          headers = {\n            'Content-Type': 'application/json'\n          };\n          if (token) {\n            headers['Authorization'] = \"Bearer \".concat(token);\n          }\n          _context3.prev = 3;\n          _context3.next = 6;\n          return axios({\n            method: method,\n            url: url,\n            data: data,\n            headers: headers\n          });\n        case 6:\n          response = _context3.sent;\n          return _context3.abrupt(\"return\", response.data);\n        case 10:\n          _context3.prev = 10;\n          _context3.t0 = _context3[\"catch\"](3);\n          if (_context3.t0.response && _context3.t0.response.status === 401) {\n            // Token inválido ou expirado, remover token do armazenamento local\n            clearAuthHeader();\n          }\n          throw _context3.t0;\n        case 14:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[3, 10]]);\n  }));\n  return function request(_x3, _x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["axios","defaults","baseURL","setAuthHeader","token","headers","common","concat","window","localStorage","setItem","clearAuthHeader","removeItem","getUserInfo","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","request","stop","apply","arguments","updateUser","_ref2","_callee2","userId","userDTO","_callee2$","_context2","_x","_x2","_ref3","_callee3","method","url","data","response","_callee3$","_context3","getItem","sent","t0","status","_x3","_x4","_x5"],"sources":["C:/Users/braia/Desktop/Ecommerce/Front/src/axios_helper.js"],"sourcesContent":["import axios from 'axios';\r\n\r\naxios.defaults.baseURL = 'http://localhost:8080';\r\n\r\nexport const setAuthHeader = (token) => {\r\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n    window.localStorage.setItem('apiToken', token);\r\n};\r\n\r\nexport const clearAuthHeader = () => {\r\n    delete axios.defaults.headers.common['Authorization'];\r\n    window.localStorage.removeItem('apiToken');\r\n};\r\n\r\nexport const getUserInfo = async () => {\r\n    return request(\"GET\", \"/auth/user-info\");\r\n};\r\n\r\nexport const updateUser = async (userId, userDTO) => {\r\n    return request(\"PUT\", `/user-profile/${userId}`, userDTO);\r\n};\r\n\r\nconst request = async (method, url, data) => {\r\n    const token = window.localStorage.getItem('apiToken');\r\n\r\n    const headers = {\r\n        'Content-Type': 'application/json',\r\n    };\r\n\r\n    if (token) {\r\n        headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n\r\n    try {\r\n        const response = await axios({\r\n            method: method,\r\n            url: url,\r\n            data: data,\r\n            headers: headers\r\n        });\r\n\r\n        return response.data;\r\n    } catch (error) {\r\n        if (error.response && error.response.status === 401) {\r\n            // Token inválido ou expirado, remover token do armazenamento local\r\n            clearAuthHeader();\r\n        }\r\n\r\n        throw error;\r\n    }\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}